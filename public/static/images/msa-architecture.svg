<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600">
  <!-- Clients -->
  <g id="clients">
    <rect x="30" y="80" width="120" height="70" rx="5" fill="#4A90E2" stroke="#2E5C8A" stroke-width="2"/>
    <text x="90" y="120" text-anchor="middle" fill="white" font-size="16" font-weight="bold">Web Client</text>

    <rect x="30" y="180" width="120" height="70" rx="5" fill="#4A90E2" stroke="#2E5C8A" stroke-width="2"/>
    <text x="90" y="220" text-anchor="middle" fill="white" font-size="16" font-weight="bold">Mobile App</text>
  </g>

  <!-- API Gateway -->
  <g id="api-gateway">
    <rect x="250" y="120" width="160" height="90" rx="8" fill="#E94B3C" stroke="#B23629" stroke-width="3"/>
    <text x="330" y="155" text-anchor="middle" fill="white" font-size="18" font-weight="bold">API Gateway</text>
    <text x="330" y="175" text-anchor="middle" fill="white" font-size="12">인증/라우팅</text>
    <text x="330" y="193" text-anchor="middle" fill="white" font-size="12">로깅/모니터링</text>
  </g>

  <!-- Arrows from clients to API Gateway -->
  <path d="M 150 115 L 250 150" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 150 215 L 250 180" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>

  <!-- BFF Layer (Optional - Dashed) -->
  <g id="bff-optional">
    <rect x="500" y="60" width="140" height="70" rx="5" fill="#BD10E0" stroke="#8B0AA8" stroke-width="2" stroke-dasharray="8,4" opacity="0.7"/>
    <text x="570" y="90" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Web BFF</text>
    <text x="570" y="108" text-anchor="middle" fill="white" font-size="11">(UI Microservice)</text>

    <rect x="500" y="200" width="140" height="70" rx="5" fill="#BD10E0" stroke="#8B0AA8" stroke-width="2" stroke-dasharray="8,4" opacity="0.7"/>
    <text x="570" y="230" text-anchor="middle" fill="white" font-size="13" font-weight="bold">Mobile BFF</text>
    <text x="570" y="248" text-anchor="middle" fill="white" font-size="11">(UI Microservice)</text>
  </g>

  <!-- Arrows from API Gateway to BFF (dashed) -->
  <path d="M 410 145 L 500 95" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <path d="M 410 175 L 500 235" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>

  <!-- Microservices -->
  <g id="services">
    <!-- User Service -->
    <rect x="750" y="30" width="150" height="80" rx="5" fill="#7ED321" stroke="#5FA319" stroke-width="2"/>
    <text x="825" y="65" text-anchor="middle" fill="white" font-size="15" font-weight="bold">User Service</text>
    <text x="825" y="88" text-anchor="middle" fill="white" font-size="12">- Node.js</text>

    <!-- Product Service -->
    <rect x="750" y="130" width="150" height="80" rx="5" fill="#F5A623" stroke="#D68910" stroke-width="2"/>
    <text x="825" y="165" text-anchor="middle" fill="white" font-size="15" font-weight="bold">Product Service</text>
    <text x="825" y="188" text-anchor="middle" fill="white" font-size="12">- Python</text>

    <!-- Order Service -->
    <rect x="750" y="230" width="150" height="80" rx="5" fill="#9013FE" stroke="#6B0FBF" stroke-width="2"/>
    <text x="825" y="265" text-anchor="middle" fill="white" font-size="15" font-weight="bold">Order Service</text>
    <text x="825" y="288" text-anchor="middle" fill="white" font-size="12">- Java</text>

    <!-- Payment Service -->
    <rect x="750" y="330" width="150" height="80" rx="5" fill="#50E3C2" stroke="#3AB39A" stroke-width="2"/>
    <text x="825" y="365" text-anchor="middle" fill="white" font-size="15" font-weight="bold">Payment Service</text>
    <text x="825" y="388" text-anchor="middle" fill="white" font-size="12">- Go</text>
  </g>

  <!-- Direct arrows from API Gateway to services (solid) -->
  <path d="M 410 130 L 750 70" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 410 165 L 750 170" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 410 190 L 750 270" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <path d="M 330 210 L 750 370" stroke="#333" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>

  <!-- Arrows from BFF to services (dashed) -->
  <path d="M 640 95 L 750 70" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <path d="M 640 95 L 750 170" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <path d="M 640 235 L 750 270" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>
  <path d="M 640 235 L 750 370" stroke="#999" stroke-width="2" stroke-dasharray="8,4" fill="none" marker-end="url(#arrowhead-dashed)"/>

  <!-- Legend -->
  <g id="legend">
    <text x="30" y="350" fill="#333" font-size="14" font-weight="bold">범례:</text>
    <line x1="30" y1="370" x2="80" y2="370" stroke="#333" stroke-width="3"/>
    <text x="90" y="375" fill="#333" font-size="13">기본 경로 (API Gateway → Services)</text>

    <line x1="30" y1="395" x2="80" y2="395" stroke="#999" stroke-width="2" stroke-dasharray="8,4"/>
    <text x="90" y="400" fill="#333" font-size="13">선택 경로 (BFF 사용 시)</text>

    <rect x="30" y="410" width="50" height="25" rx="3" fill="#BD10E0" stroke="#8B0AA8" stroke-width="2" stroke-dasharray="8,4" opacity="0.7"/>
    <text x="90" y="428" fill="#333" font-size="13">선택적 컴포넌트</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
    <marker id="arrowhead-dashed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#999"/>
    </marker>
  </defs>
</svg>
